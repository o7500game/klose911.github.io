<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Two Factor Authentication</title>
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<meta  name="author" content="Wu, Shanliang" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<link rel="stylesheet" type="text/css" href="css/main.css" />
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Two Factor Authentication</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">Service Overview</a></li>
<li><a href="#sec-2">User Scenario</a>
<ul>
<li><a href="#sec-2-1">Description</a></li>
<li><a href="#sec-2-2">Scenario</a>
<ul>
<li><a href="#sec-2-2-1">Login System</a></li>
<li><a href="#sec-2-2-2">Change Password</a></li>
<li><a href="#sec-2-2-3">Forget Password</a></li>
<li><a href="#sec-2-2-4">Unlock Account</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-3">User Guidance</a>
<ul>
<li><a href="#sec-3-1">Overview</a></li>
<li><a href="#sec-3-2">Detail</a>
<ul>
<li><a href="#sec-3-2-1">Send verification code</a></li>
<li><a href="#sec-3-2-2">Verfiy passcode</a></li>
<li><a href="#sec-3-2-3">Source Code</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<p>
Two factor authentication is a fundemental service provided by eBaoCloud Platform. It makes eaiser for developers to rapidly implement sms authentication.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1">Service Overview</h2>
<div class="outline-text-2" id="text-1">
<p>
Two factor authentication service provides the apis to send sms code and verify passcode. 
</p>

<p>
With two factor authentication service you don't worry about the implementation details, like how to generate code, how to send sms, how to expired the code, how to limit request frequency. Therefore it helps developers more quickly to integrate sms authefication into his system. 
</p>
</div>
</div>

<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2">User Scenario</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-sec-2-1" class="outline-3">
<h3 id="sec-2-1">Description</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Two-Factor Authentication adds an extra step of entering a random passcode sent via an SMS as an added layer of protection.    
</p>
</div>
</div>

<div id="outline-container-sec-2-2" class="outline-3">
<h3 id="sec-2-2">Scenario</h3>
<div class="outline-text-3" id="text-2-2">
</div><div id="outline-container-sec-2-2-1" class="outline-4">
<h4 id="sec-2-2-1">Login System</h4>
<div class="outline-text-4" id="text-2-2-1">
<p>
When signing onto system, the verfication code needs to be sent to user's mobile.
</p>
</div>
</div>

<div id="outline-container-sec-2-2-2" class="outline-4">
<h4 id="sec-2-2-2">Change Password</h4>
<div class="outline-text-4" id="text-2-2-2">
<p>
While changing password, user should input the verfication code together.  
</p>
</div>
</div>

<div id="outline-container-sec-2-2-3" class="outline-4">
<h4 id="sec-2-2-3">Forget Password</h4>
<div class="outline-text-4" id="text-2-2-3">
<p>
If user forgets password, he have to prove his identiy via sms message 
</p>
</div>
</div>

<div id="outline-container-sec-2-2-4" class="outline-4">
<h4 id="sec-2-2-4">Unlock Account</h4>
<div class="outline-text-4" id="text-2-2-4">
<p>
Account could be locked after trying wrong password too many times. On this case, user must unlock his account by sms.  
</p>
</div>
</div>
</div>
</div>

<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3">User Guidance</h2>
<div class="outline-text-2" id="text-3">
</div><div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1">Overview</h3>
<div class="outline-text-3" id="text-3-1">
<ol class="org-ol">
<li>Send verification code: send a sms with random generated six-digit code to user's mobile
</li>
<li>Verfiy passcode: Check whether the passcode entered by user is valid or not. The reuired parameter are the mobile number, the pass code to verify, and the token of client
</li>
</ol>
</div>
</div>

<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2">Detail</h3>
<div class="outline-text-3" id="text-3-2">
</div><div id="outline-container-sec-3-2-1" class="outline-4">
<h4 id="sec-3-2-1">Send verification code</h4>
<div class="outline-text-4" id="text-3-2-1">
<ul class="org-ul">
<li>path: /2fa/sendCode
</li>
<li>request type: POST
</li>
<li>content-type: application/json
</li>
</ul>
</div>
<ul class="org-ul"><li><a id="sec-3-2-1-1" name="sec-3-2-1-1"></a>Request Parameter<br  /><div class="outline-text-5" id="text-3-2-1-1">
<table border="1" cellspacing="0" cellpadding="6" rules="all" frame="boader">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">Parameter</td>
<td class="left">Data type</td>
<td class="left">Required</td>
<td class="left">Description</td>
<td class="left">Example</td>
</tr>

<tr>
<td class="left">phoneNumber</td>
<td class="left">String</td>
<td class="left">required</td>
<td class="left">the number of phone to send sms, format: +CountryCode Phonenumber</td>
<td class="left">+86 13118101234</td>
</tr>
</tbody>
</table>

<div class="org-src-container">

<pre class="src src-js">{<span style="color: #ffa07a;">"phoneNumber"</span>: <span style="color: #ffa07a;">"+86 1234567890"</span>}
</pre>
</div>
</div>
</li>

<li><a id="sec-3-2-1-2" name="sec-3-2-1-2"></a>Response Result<br  /><div class="outline-text-5" id="text-3-2-1-2">
<table border="1" cellspacing="0" cellpadding="6" rules="all" frame="boader">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">Field</td>
<td class="left">Data type</td>
<td class="left">Description</td>
<td class="left">Example</td>
</tr>

<tr>
<td class="left">message</td>
<td class="left">String</td>
<td class="left">error message, it will be empty string if code is successfuly sent</td>
<td class="left">"phone number is blank"</td>
</tr>

<tr>
<td class="left">token</td>
<td class="left">String</td>
<td class="left">the identification of client's session</td>
<td class="left">"abcdefgh"</td>
</tr>

<tr>
<td class="left">isSuccessful</td>
<td class="left">boolean</td>
<td class="left">whether the sms was succesfully sent or not</td>
<td class="left">true/false</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>Successful

<div class="org-src-container">

<pre class="src src-js">{<span style="color: #ffa07a;">"message"</span>:<span style="color: #ffa07a;">""</span>, <span style="color: #ffa07a;">"token"</span>:<span style="color: #ffa07a;">"abcdefgh"</span>, <span style="color: #ffa07a;">"isSuccessful"</span>: <span style="color: #7fffd4;">true</span>}
</pre>
</div>
</li>

<li>Failed
</li>
</ul>

<div class="org-src-container">

<pre class="src src-js">{<span style="color: #ffa07a;">"message"</span>:<span style="color: #ffa07a;">"phone number is blank"</span>, <span style="color: #ffa07a;">"token"</span>:<span style="color: #ffa07a;">""</span>, <span style="color: #ffa07a;">"isSuccessful"</span>: <span style="color: #7fffd4;">false</span>}
</pre>
</div>
</div>
</li></ul>
</div>

<div id="outline-container-sec-3-2-2" class="outline-4">
<h4 id="sec-3-2-2">Verfiy passcode</h4>
<div class="outline-text-4" id="text-3-2-2">
<ul class="org-ul">
<li>path：/2fa/verifyCode
</li>
<li>request type：POST
</li>
<li>content type：application/json
</li>
<li>sms-token: Http Head, it must equal as the token returned by the invoke of 'send' rest api
</li>
</ul>
</div>

<ul class="org-ul"><li><a id="sec-3-2-2-1" name="sec-3-2-2-1"></a>Request Parameter<br  /><div class="outline-text-5" id="text-3-2-2-1">
<table border="1" cellspacing="0" cellpadding="6" rules="all" frame="boader">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">Parameter</td>
<td class="left">Data type</td>
<td class="left">Required</td>
<td class="left">Description</td>
<td class="left">Example</td>
</tr>

<tr>
<td class="left">phoneNumber</td>
<td class="left">String</td>
<td class="left">Required</td>
<td class="left">the number of phone to send sms, format: +CountryCode Phonenumber</td>
<td class="left">+86 13118101234</td>
</tr>

<tr>
<td class="left">code</td>
<td class="left">String</td>
<td class="left">Required</td>
<td class="left">the passcode entered by user</td>
<td class="left">123456</td>
</tr>
</tbody>
</table>
</div>
</li>


<li><a id="sec-3-2-2-2" name="sec-3-2-2-2"></a>Response Result<br  /><div class="outline-text-5" id="text-3-2-2-2">
<table border="1" cellspacing="0" cellpadding="6" rules="all" frame="boader">


<colgroup>
<col  class="left" />

<col  class="left" />

<col  class="left" />

<col  class="left" />
</colgroup>
<tbody>
<tr>
<td class="left">Parameter</td>
<td class="left">Data type</td>
<td class="left">Description</td>
<td class="left">Example</td>
</tr>

<tr>
<td class="left">errorMessage</td>
<td class="left">String</td>
<td class="left">error message, it will be empty string if the code is valid</td>
<td class="left">"verification code expired"</td>
</tr>

<tr>
<td class="left">isVerified</td>
<td class="left">boolean</td>
<td class="left">the code is valid or not</td>
<td class="left">true/false</td>
</tr>
</tbody>
</table>

<ul class="org-ul">
<li>Valid Code

<div class="org-src-container">

<pre class="src src-js">{<span style="color: #ffa07a;">"errorMessage"</span>:<span style="color: #ffa07a;">""</span>, <span style="color: #ffa07a;">"isVerified"</span>: <span style="color: #7fffd4;">true</span>}
</pre>
</div>
</li>

<li>Invalid Code
</li>
</ul>

<div class="org-src-container">

<pre class="src src-js">{<span style="color: #ffa07a;">"errorMessage"</span>:<span style="color: #ffa07a;">"wrong verfication code"</span>, <span style="color: #ffa07a;">"isVerified"</span>: <span style="color: #7fffd4;">false</span>}
</pre>
</div>
</div>
</li></ul>
</div>

<div id="outline-container-sec-3-2-3" class="outline-4">
<h4 id="sec-3-2-3">Source Code</h4>
<div class="outline-text-4" id="text-3-2-3">
</div><ul class="org-ul"><li><a id="sec-3-2-3-1" name="sec-3-2-3-1"></a>curl<br  /><div class="outline-text-5" id="text-3-2-3-1">
<ul class="org-ul">
<li>Send verfication code

<div class="org-src-container">

<pre class="src src-sh">curl --request POST <span style="color: #ffa07a;">\</span>
  --url https://sandbox.gw.ebaocloud.com.cn/eBao/1.0/2fa/sendCode <span style="color: #ffa07a;">\</span>
  --header <span style="color: #ffa07a;">'content-type: application/json'</span> <span style="color: #ffa07a;">\</span>
  --data <span style="color: #ffa07a;">'{</span>
<span style="color: #ffa07a;">        "phoneNumber": "+86 1234567778"</span>
<span style="color: #ffa07a;">}'</span>
</pre>
</div>
</li>

<li>Verfiy passcode

<div class="org-src-container">

<pre class="src src-sh">curl --request POST <span style="color: #ffa07a;">\</span>
  --url http://sandbox.gw.ebaocloud.com.cn/eBao/1.0/2fa/verifyCode <span style="color: #ffa07a;">\</span>
  --header <span style="color: #ffa07a;">'content-type: application/json'</span> <span style="color: #ffa07a;">\</span>
  --header <span style="color: #ffa07a;">'sms-token: ghiha2t2h7kfe55pjj2vvpreru'</span> <span style="color: #ffa07a;">\</span>
  --data <span style="color: #ffa07a;">'{</span>
<span style="color: #ffa07a;">    "phoneNumber": "+86 1234567778",</span>
<span style="color: #ffa07a;">    "code": "712039"</span>
<span style="color: #ffa07a;">}'</span>
</pre>
</div>
</li>
</ul>
</div>
</li>

<li><a id="sec-3-2-3-2" name="sec-3-2-3-2"></a>Java<br  /><div class="outline-text-5" id="text-3-2-3-2">
<ul class="org-ul">
<li>Send verfication code

<div class="org-src-container">

<pre class="src src-java"><span style="color: #98fb98;">OkHttpClient</span> <span style="color: #eedd82;">client</span> = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">OkHttpClient</span>();

<span style="color: #98fb98;">MediaType</span> <span style="color: #eedd82;">mediaType</span> = MediaType.parse(<span style="color: #ffa07a;">"application/json"</span>);
<span style="color: #98fb98;">RequestBody</span> <span style="color: #eedd82;">body</span> = RequestBody.create(mediaType, <span style="color: #ffa07a;">"{\n\t\"phoneNumber\": \"+86 1234567778\"\n}"</span>);
<span style="color: #98fb98;">Request</span> <span style="color: #eedd82;">request</span> = <span style="color: #00ffff;">new</span> <span style="color: #7fffd4;">Request</span>.<span style="color: #98fb98;">Builder</span>()
    .url(<span style="color: #ffa07a;">"https://sandbox.gw.ebaocloud.com.cn/eBao/1.0/2fa/sendCode"</span>)
    .post(body)
    .addHeader(<span style="color: #ffa07a;">"content-type"</span>, <span style="color: #ffa07a;">"application/json"</span>)
    .build();

<span style="color: #98fb98;">Response</span> <span style="color: #eedd82;">response</span> = client.newCall(request).execute();
</pre>
</div>
</li>

<li>Verfiy passcode

<div class="org-src-container">

<pre class="src src-java"><span style="color: #98fb98;">OkHttpClient</span> <span style="color: #eedd82;">client</span> = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">OkHttpClient</span>();

<span style="color: #98fb98;">MediaType</span> <span style="color: #eedd82;">mediaType</span> = MediaType.parse(<span style="color: #ffa07a;">"application/json"</span>);
<span style="color: #98fb98;">RequestBody</span> <span style="color: #eedd82;">body</span> = RequestBody.create(mediaType, <span style="color: #ffa07a;">"{\n    \"phoneNumber\": \"+86 1234567778\",\n    \"code\": \"712039\"\n}"</span>);
<span style="color: #98fb98;">Request</span> <span style="color: #eedd82;">request</span> = <span style="color: #00ffff;">new</span> <span style="color: #7fffd4;">Request</span>.<span style="color: #98fb98;">Builder</span>()
    .url(<span style="color: #ffa07a;">"http://sandbox.gw.ebaocloud.com.cn/eBao/1.0/2fa/verifyCode"</span>)
    .post(body)
    .addHeader(<span style="color: #ffa07a;">"sms-token"</span>, <span style="color: #ffa07a;">"ghiha2t2h7kfe55pjj2vvpreru"</span>)
    .addHeader(<span style="color: #ffa07a;">"content-type"</span>, <span style="color: #ffa07a;">"application/json"</span>)
    .build();

<span style="color: #98fb98;">Response</span> <span style="color: #eedd82;">response</span> = client.newCall(request).execute();
</pre>
</div>
</li>
</ul>
</div>
</li>

<li><a id="sec-3-2-3-3" name="sec-3-2-3-3"></a>nodejs<br  /><div class="outline-text-5" id="text-3-2-3-3">
<ul class="org-ul">
<li>Send verfication code

<div class="org-src-container">

<pre class="src src-js"><span style="color: #00ffff;">var</span> <span style="color: #eedd82;">http</span> = require(<span style="color: #ffa07a;">"https"</span>);

<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">options</span> = {
    <span style="color: #ffa07a;">"method"</span>: <span style="color: #ffa07a;">"POST"</span>,
    <span style="color: #ffa07a;">"hostname"</span>: <span style="color: #ffa07a;">"sandbox.gw.ebaocloud.com.cn"</span>,
    <span style="color: #ffa07a;">"port"</span>: <span style="color: #7fffd4;">null</span>,
    <span style="color: #ffa07a;">"path"</span>: <span style="color: #ffa07a;">"/eBao/1.0/2fa/sendCode"</span>,
    <span style="color: #ffa07a;">"headers"</span>: {
        <span style="color: #ffa07a;">"content-type"</span>: <span style="color: #ffa07a;">"application/json"</span>,
        <span style="color: #ffa07a;">"content-length"</span>: <span style="color: #ffa07a;">"36"</span>
    }
};

<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">req</span> = http.request(options, <span style="color: #00ffff;">function</span> (<span style="color: #eedd82;">res</span>) {
    <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">chunks</span> = [];

    res.on(<span style="color: #ffa07a;">"data"</span>, <span style="color: #00ffff;">function</span> (<span style="color: #eedd82;">chunk</span>) {
        chunks.push(chunk);
    });

    res.on(<span style="color: #ffa07a;">"end"</span>, <span style="color: #00ffff;">function</span> () {
        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">body</span> = Buffer.concat(chunks);
        console.log(body.toString());
    });
});

req.write(JSON.stringify({ phoneNumber: <span style="color: #ffa07a;">'+86 1234567778'</span> }));
req.end();
</pre>
</div>
</li>

<li>Verfiy passcode

<div class="org-src-container">

<pre class="src src-js"><span style="color: #00ffff;">var</span> <span style="color: #eedd82;">http</span> = require(<span style="color: #ffa07a;">"http"</span>);

<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">options</span> = {
    <span style="color: #ffa07a;">"method"</span>: <span style="color: #ffa07a;">"POST"</span>,
    <span style="color: #ffa07a;">"hostname"</span>: <span style="color: #ffa07a;">"sandbox.gw.ebaocloud.com.cn"</span>,
    <span style="color: #ffa07a;">"port"</span>: <span style="color: #7fffd4;">null</span>,
    <span style="color: #ffa07a;">"path"</span>: <span style="color: #ffa07a;">"/eBao/1.0/2fa/verifyCode"</span>,
    <span style="color: #ffa07a;">"headers"</span>: {
        <span style="color: #ffa07a;">"sms-token"</span>: <span style="color: #ffa07a;">"ghiha2t2h7kfe55pjj2vvpreru"</span>,
        <span style="color: #ffa07a;">"content-type"</span>: <span style="color: #ffa07a;">"application/json"</span>,
        <span style="color: #ffa07a;">"content-length"</span>: <span style="color: #ffa07a;">"61"</span>
    }
};

<span style="color: #00ffff;">var</span> <span style="color: #eedd82;">req</span> = http.request(options, <span style="color: #00ffff;">function</span> (<span style="color: #eedd82;">res</span>) {
    <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">chunks</span> = [];

    res.on(<span style="color: #ffa07a;">"data"</span>, <span style="color: #00ffff;">function</span> (<span style="color: #eedd82;">chunk</span>) {
        chunks.push(chunk);
    });

    res.on(<span style="color: #ffa07a;">"end"</span>, <span style="color: #00ffff;">function</span> () {
        <span style="color: #00ffff;">var</span> <span style="color: #eedd82;">body</span> = Buffer.concat(chunks);
        console.log(body.toString());
    });
});

req.write(JSON.stringify({ phoneNumber: <span style="color: #ffa07a;">'+86 1234567778'</span>, code: <span style="color: #ffa07a;">'712039'</span> }));
req.end();
</pre>
</div>
</li>
</ul>
</div>
</li>

<li><a id="sec-3-2-3-4" name="sec-3-2-3-4"></a>c#<br  /><div class="outline-text-5" id="text-3-2-3-4">
<ul class="org-ul">
<li>Send verfication code

<div class="org-src-container">

<pre class="src src-c++"><span style="color: #98fb98;">var</span> <span style="color: #eedd82;">client</span> = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">RestClient</span>(<span style="color: #ffa07a;">"https://sandbox.gw.ebaocloud.com.cn/eBao/1.0/2fa/sendCode"</span>);
<span style="color: #98fb98;">var</span> <span style="color: #eedd82;">request</span> = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">RestRequest</span>(Method.POST);
request.AddHeader(<span style="color: #ffa07a;">"content-type"</span>, <span style="color: #ffa07a;">"application/json"</span>);
request.AddParameter(<span style="color: #ffa07a;">"application/json"</span>, <span style="color: #ffa07a;">"{\n\t\"phoneNumber\": \"+86 1234567778\"\n}"</span>, ParameterType.RequestBody);
<span style="color: #98fb98;">IRestResponse</span> <span style="color: #eedd82;">response</span> = client.Execute(request);
</pre>
</div>
</li>

<li>Verfiy passcode

<div class="org-src-container">

<pre class="src src-c++"><span style="color: #98fb98;">var</span> <span style="color: #eedd82;">client</span> = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">RestClient</span>(<span style="color: #ffa07a;">"http://sandbox.gw.ebaocloud.com.cn/eBao/1.0/2fa/verifyCode"</span>);
<span style="color: #98fb98;">var</span> <span style="color: #eedd82;">request</span> = <span style="color: #00ffff;">new</span> <span style="color: #98fb98;">RestRequest</span>(Method.POST);
request.AddHeader(<span style="color: #ffa07a;">"content-type"</span>, <span style="color: #ffa07a;">"application/json"</span>);
request.AddHeader(<span style="color: #ffa07a;">"sms-token"</span>, <span style="color: #ffa07a;">"ghiha2t2h7kfe55pjj2vvpreru"</span>);
request.AddParameter(<span style="color: #ffa07a;">"application/json"</span>, <span style="color: #ffa07a;">"{\n    \"phoneNumber\": \"+86 1234567778\",\n    \"code\": \"712039\"\n}"</span>, ParameterType.RequestBody);
<span style="color: #98fb98;">IRestResponse</span> <span style="color: #eedd82;">response</span> = client.Execute(request);
</pre>
</div>
</li>
</ul>
</div>
</li>

<li><a id="sec-3-2-3-5" name="sec-3-2-3-5"></a>php<br  /><div class="outline-text-5" id="text-3-2-3-5">
<ul class="org-ul">
<li>Send verfication code

<div class="org-src-container">

<pre class="src src-perl">&lt;?php

$<span style="color: #eedd82;">client</span> = new http\Client;
$<span style="color: #eedd82;">request</span> = new http\Client\Request;

$<span style="color: #eedd82;">body</span> = new http\Message\Body;
$<span style="color: #eedd82;">body</span>-&gt;append(<span style="color: #ffa07a;">'{</span>
<span style="color: #ffa07a;">        "phoneNumber": "+86 1234567778"</span>
<span style="color: #ffa07a;">}'</span>);

$<span style="color: #eedd82;">request</span>-&gt;setRequestUrl(<span style="color: #ffa07a;">'https://sandbox.gw.ebaocloud.com.cn/eBao/1.0/2fa/sendCode'</span>);
$<span style="color: #eedd82;">request</span>-&gt;setRequestMethod(<span style="color: #ffa07a;">'POST'</span>);
$<span style="color: #eedd82;">request</span>-&gt;setBody($<span style="color: #eedd82;">body</span>);

$<span style="color: #eedd82;">request</span>-&gt;setHeaders(array(
  <span style="color: #ffa07a;">'content-type'</span> =&gt; <span style="color: #ffa07a;">'application/json'</span>
));

$<span style="color: #eedd82;">client</span>-&gt;enqueue($<span style="color: #eedd82;">request</span>)-&gt;send();
$<span style="color: #eedd82;">response</span> = $<span style="color: #eedd82;">client</span>-&gt;getResponse();

echo $<span style="color: #eedd82;">response</span>-&gt;getBody();
</pre>
</div>
</li>

<li>Verfiy passcode

<div class="org-src-container">

<pre class="src src-perl">&lt;?php

$<span style="color: #eedd82;">client</span> = new http\Client;
$<span style="color: #eedd82;">request</span> = new http\Client\Request;

$<span style="color: #eedd82;">body</span> = new http\Message\Body;
$<span style="color: #eedd82;">body</span>-&gt;append(<span style="color: #ffa07a;">'{</span>
<span style="color: #ffa07a;">    "phoneNumber": "+86 1234567778",</span>
<span style="color: #ffa07a;">    "code": "712039"</span>
<span style="color: #ffa07a;">}'</span>);

$<span style="color: #eedd82;">request</span>-&gt;setRequestUrl(<span style="color: #ffa07a;">'http://sandbox.gw.ebaocloud.com.cn/eBao/1.0/2fa/verifyCode'</span>);
$<span style="color: #eedd82;">request</span>-&gt;setRequestMethod(<span style="color: #ffa07a;">'POST'</span>);
$<span style="color: #eedd82;">request</span>-&gt;setBody($<span style="color: #eedd82;">body</span>);

$<span style="color: #eedd82;">request</span>-&gt;setHeaders(array(
  <span style="color: #ffa07a;">'content-type'</span> =&gt; <span style="color: #ffa07a;">'application/json'</span>,
  <span style="color: #ffa07a;">'sms-token'</span> =&gt; <span style="color: #ffa07a;">'ghiha2t2h7kfe55pjj2vvpreru'</span>
));

$<span style="color: #eedd82;">client</span>-&gt;enqueue($<span style="color: #eedd82;">request</span>)-&gt;send();
$<span style="color: #eedd82;">response</span> = $<span style="color: #eedd82;">client</span>-&gt;getResponse();

echo $<span style="color: #eedd82;">response</span>-&gt;getBody();
</pre>
</div>
</li>
</ul>
</div>
</li>

<li><a id="sec-3-2-3-6" name="sec-3-2-3-6"></a>Python<br  /><div class="outline-text-5" id="text-3-2-3-6">
<ul class="org-ul">
<li>Send verfication code

<div class="org-src-container">

<pre class="src src-python"><span style="color: #00ffff;">import</span> requests

<span style="color: #eedd82;">url</span> = <span style="color: #ffa07a;">"https://sandbox.gw.ebaocloud.com.cn/eBao/1.0/2fa/sendCode"</span>

<span style="color: #eedd82;">payload</span> = <span style="color: #ffa07a;">"{\n\t\"phoneNumber\": \"+86 1234567778\"\n}"</span>
<span style="color: #eedd82;">headers</span> = {<span style="color: #ffa07a;">'content-type'</span>: <span style="color: #ffa07a;">'application/json'</span>}

<span style="color: #eedd82;">response</span> = requests.request(<span style="color: #ffa07a;">"POST"</span>, url, data=payload, headers=headers)

<span style="color: #00ffff;">print</span>(response.text)
</pre>
</div>
</li>

<li>Verfiy passcode

<div class="org-src-container">

<pre class="src src-python"><span style="color: #00ffff;">import</span> requests

<span style="color: #eedd82;">url</span> = <span style="color: #ffa07a;">"http://sandbox.gw.ebaocloud.com.cn/eBao/1.0/2fa/verifyCode"</span>

<span style="color: #eedd82;">payload</span> = <span style="color: #ffa07a;">"{\n    \"phoneNumber\": \"+86 1234567778\",\n    \"code\": \"712039\"\n}"</span>
<span style="color: #eedd82;">headers</span> = {
<span style="background-color: #1a1a1a;"> </span>   <span style="color: #ffa07a;">'sms-token'</span>: <span style="color: #ffa07a;">"ghiha2t2h7kfe55pjj2vvpreru"</span>,
<span style="background-color: #1a1a1a;"> </span>   <span style="color: #ffa07a;">'content-type'</span>: <span style="color: #ffa07a;">"application/json"</span>
<span style="background-color: #1a1a1a;"> </span>   }

<span style="color: #eedd82;">response</span> = requests.request(<span style="color: #ffa07a;">"POST"</span>, url, data=payload, headers=headers)

<span style="color: #00ffff;">print</span>(response.text)
</pre>
</div>
</li>
</ul>
</div>
</li>

<li><a id="sec-3-2-3-7" name="sec-3-2-3-7"></a>ObjectC<br  /><div class="outline-text-5" id="text-3-2-3-7">
<ul class="org-ul">
<li>Send verfication code

<div class="org-src-container">

<pre class="src src-C++"><span style="color: #7fffd4;">#import</span> &lt;Foundation/Foundation.h&gt;

<span style="color: #98fb98;">NSDictionary</span> *<span style="color: #eedd82;">headers</span> = @{ @<span style="color: #ffa07a;">"content-type"</span>: @<span style="color: #ffa07a;">"application/json"</span> };
<span style="color: #98fb98;">NSDictionary</span> *<span style="color: #eedd82;">parameters</span> = @{ @<span style="color: #ffa07a;">"phoneNumber"</span>: @<span style="color: #ffa07a;">"+86 1234567778"</span> };

<span style="color: #98fb98;">NSData</span> *<span style="color: #eedd82;">postData</span> = [NSJSONSerialization dataWithJSONObject:parameters options:0 error:nil];

<span style="color: #98fb98;">NSMutableURLRequest</span> *<span style="color: #eedd82;">request</span> = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@<span style="color: #ffa07a;">"https://sandbox.gw.ebaocloud.com.cn/eBao/1.0/2fa/sendCode"</span>]
                               cachePolicy:NSURLRequestUseProtocolCachePolicy
                           timeoutInterval:10.0];
[request setHTTPMethod:@<span style="color: #ffa07a;">"POST"</span>];
[request setAllHTTPHeaderFields:headers];
[request setHTTPBody:postData];

<span style="color: #98fb98;">NSURLSession</span> *<span style="color: #eedd82;">session</span> = [NSURLSession sharedSession];
<span style="color: #98fb98;">NSURLSessionDataTask</span> *<span style="color: #eedd82;">dataTask</span> = [session dataTaskWithRequest:request
                        completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {
                        <span style="color: #00ffff;">if</span> (error) {
                            NSLog(@<span style="color: #ffa07a;">"%@"</span>, error);
                        } <span style="color: #00ffff;">else</span> {
                            <span style="color: #98fb98;">NSHTTPURLResponse</span> *<span style="color: #eedd82;">httpResponse</span> = (<span style="color: #98fb98;">NSHTTPURLResponse</span> *) response;
                            NSLog(@<span style="color: #ffa07a;">"%@"</span>, httpResponse);
                        }
                        }];
[dataTask resume];
</pre>
</div>
</li>

<li>Verfiy passcode

<div class="org-src-container">

<pre class="src src-C++"><span style="color: #7fffd4;">#import</span> &lt;Foundation/Foundation.h&gt;

<span style="color: #98fb98;">NSDictionary</span> *<span style="color: #eedd82;">headers</span> = @{ @<span style="color: #ffa07a;">"sms-token"</span>: @<span style="color: #ffa07a;">"ghiha2t2h7kfe55pjj2vvpreru"</span>,
               @<span style="color: #ffa07a;">"content-type"</span>: @<span style="color: #ffa07a;">"application/json"</span> };
<span style="color: #98fb98;">NSDictionary</span> *<span style="color: #eedd82;">parameters</span> = @{ @<span style="color: #ffa07a;">"phoneNumber"</span>: @<span style="color: #ffa07a;">"+86 1234567778"</span>,
                  @<span style="color: #ffa07a;">"code"</span>: @<span style="color: #ffa07a;">"712039"</span> };

<span style="color: #98fb98;">NSData</span> *<span style="color: #eedd82;">postData</span> = [NSJSONSerialization dataWithJSONObject:parameters options:0 error:nil];

<span style="color: #98fb98;">NSMutableURLRequest</span> *<span style="color: #eedd82;">request</span> = [NSMutableURLRequest requestWithURL:[NSURL URLWithString:@<span style="color: #ffa07a;">"http://sandbox.gw.ebaocloud.com.cn/eBao/1.0/2fa/verifyCode"</span>]
                               cachePolicy:NSURLRequestUseProtocolCachePolicy
                           timeoutInterval:10.0];
[request setHTTPMethod:@<span style="color: #ffa07a;">"POST"</span>];
[request setAllHTTPHeaderFields:headers];
[request setHTTPBody:postData];

<span style="color: #98fb98;">NSURLSession</span> *<span style="color: #eedd82;">session</span> = [NSURLSession sharedSession];
<span style="color: #98fb98;">NSURLSessionDataTask</span> *<span style="color: #eedd82;">dataTask</span> = [session dataTaskWithRequest:request
                        completionHandler:^(NSData *data, NSURLResponse *response, NSError *error) {
                        <span style="color: #00ffff;">if</span> (error) {
                            NSLog(@<span style="color: #ffa07a;">"%@"</span>, error);
                        } <span style="color: #00ffff;">else</span> {
                            <span style="color: #98fb98;">NSHTTPURLResponse</span> *<span style="color: #eedd82;">httpResponse</span> = (<span style="color: #98fb98;">NSHTTPURLResponse</span> *) response;
                            NSLog(@<span style="color: #ffa07a;">"%@"</span>, httpResponse);
                        }
                        }];
[dataTask resume];
</pre>
</div>
</li>
</ul>
</div>
</li></ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Wu, Shanliang</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.1.1 (<a href="http://orgmode.org">Org</a> mode 8.2.10)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
